<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
  <button onclick = "doCORSRequest();" >Load WebPage</button>
  <input type="url" id="Url" size="100">
    <script type = "text/javascript">
        if ('serviceWorker' in navigator) {
            // window.addEventListener('load', function () {
            navigator.serviceWorker.register('cros-proxy-service-worker.js').then(function (registration) {
                // Registration was successful
                console.log('ServiceWorker registration successful with scope: ', registration.scope);
                return;
            }, function (err) {
                // registration failed :(
                console.log('ServiceWorker registration failed: ', err);
                return err;
            });
            // });
        }

        var cors_api_url = 'http://127.0.0.1:3000/' ? 'http://127.0.0.1:3000/' : 'https://cros-proxy-testing.glitch.me/';
        function doCORSRequest() {
            var url = document.getElementById('Url').value; 
            var x = new XMLHttpRequest();
            x.open("GET", cors_api_url + url);
            x.onload = x.onerror = function () {
                console.log(
                    "GET" + ' ' + url + '\n' +
                    x.status + ' ' + x.statusText
                );
                window.document.getElementsByTagName('html')[0].innerHTML = "";
                window.document.write(x.responseText)
            };
            document.cookie = "CURRENT_URL=" + url + "; path = '/'"; 
            x.send("");
        }
        // doCORSRequest("https://discord.com")
    </script>
</body>
</html>